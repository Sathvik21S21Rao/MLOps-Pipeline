apiVersion: v1
kind: Service
metadata:
  name: "{{ service_name | default('model-inference-service') }}"
  namespace: {{ k8s_namespace }}
  labels:
    app: "{{ app_label | default('modelinference') }}"
spec:
  type: "{{ service_type | default('ClusterIP') }}"
  selector:
    app: "{{ app_label | default('modelinference') }}"
  ports:
    - name: http
      protocol: TCP
      port: {{ service_port | default(80) }}
      targetPort: {{ target_port | default(8080) }}

# Optional: expose via LoadBalancer when requested
{% if service_type | default('ClusterIP') == 'LoadBalancer' and loadbalancer_ingress is defined %}
status:
  loadBalancer:
    ingress:
      - ip: {{ loadbalancer_ingress }}
{% endif %}
